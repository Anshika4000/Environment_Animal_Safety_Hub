(function(){'use strict';function getToggleBtn(){return document.getElementById('themeToggle');}function updateIcon(theme){const toggleBtn=getToggleBtn();if(!toggleBtn)return;const icon=toggleBtn.querySelector('i');if(!icon)return;icon.classList.remove('fa-sun','fa-moon');icon.classList.add(theme==='dark' ? 'fa-sun' : 'fa-moon');toggleBtn.setAttribute('aria-label',theme==='dark' ? 'Switch to light mode' : 'Switch to dark mode');}function animateTransition(){const root=document.documentElement;root.classList.add('theme-transitioning');setTimeout(()=> root.classList.remove('theme-transitioning'),400);}function handleToggleClick(){if(window.PreferencesManager){animateTransition();window.PreferencesManager.toggleTheme();console.log('🌗 Theme toggled');}else{console.warn('[ThemeToggle] PreferencesManager not available');}}function init(){// Get current theme from PreferencesManager or fallback const currentTheme=window.PreferencesManager ? window.PreferencesManager.getTheme():(localStorage.getItem('ecolife_theme')|| 'light');// Update icon to reflect current theme updateIcon(currentTheme);// Subscribe to theme changes from PreferencesManager if(window.PreferencesManager){window.PreferencesManager.subscribe('theme',(newTheme)=>{updateIcon(newTheme);});}// Set up click handler using event delegation document.addEventListener('click',(e)=>{const btn=e.target.closest('#themeToggle');if(btn)handleToggleClick();});}// Wait for DOM and PreferencesManager to be ready if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{// DOM already loaded,wait a tick for PreferencesManager setTimeout(init,0);}// Expose init function globally for component-loader window.initThemeToggle=init;})();